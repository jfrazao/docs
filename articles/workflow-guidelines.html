<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Workflow Design Guidelines </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Workflow Design Guidelines ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <div class="masthead">
          <div class="masthead__inner-wrap container">
            <div class="masthead__menu">
              <nav id="site-nav" class="greedy-nav">
                
                <a class="navbar-brand" href="//bonsai-rx.org/">
                  <img id="logo" class="svg" src="../logo.svg" alt="">
                </a>
                <ul class="visible-links">
                  <li class="masthead__menu-item"><a href="../.">Docs</a></li>
                  <li class="masthead__menu-item"><a href="//bonsai-rx.org/learn">Learn</a></li>
                  <li class="masthead__menu-item"><a href="//bonsai-rx.org/community">Community</a></li>
                </ul>
                <button class="greedy-nav__toggle hidden" type="button">
                  <div class="navicon"></div>
                </button>
                <ul class="hidden-links hidden"></ul>
              </nav>
            </div>
          </div>
        </div>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="workflow-guidelines">
<h1 id="workflow-design-guidelines">Workflow Design Guidelines</h1>

<p>This section offers guidelines and design patterns to consider when developing workflows for any reactive program.</p>
<h2 id="workflow-organization">Workflow Organization</h2>
<div class="do"><p>use <code>GroupWorkflow</code> nodes to separate independent functionality (e.g. acquisition, visualization and processing).</p>
</div>
<div class="avoid"><p>branching without merging.</p>
</div>
<h2 id="subject-declaration">Subject Declaration</h2>
<p>Using subjects is one of the most important techniques for improving readability and managing the complexity of large workflows. Subjects make it possible to reduce the number of branches in the workflow and also allow abstraction over data sources and sinks so that you can easily replace different components. Finally, subjects are fundamental for managing and storing data inside nested operators.</p>
<div class="do"><p>prefer using subjects over branches when sharing sequences across independent sections of the workflow.</p>
</div>
<div class="do"><p>use a <a class="xref" href="../api/Bonsai.Reactive.BehaviorSubject.html"><code>BehaviorSubject</code></a> to share global state which can be accessed by multiple consumers and modified by multiple producers.</p>
</div>
<div class="avoid"><p>using <a href="xref:Bonsai.Reactive.MulticastSubject"><code>MulticastSubject</code></a> on variables which are not declared as <a class="xref" href="../api/Bonsai.Reactive.BehaviorSubject.html"><code>BehaviorSubject</code></a>. This will prevent accidental termination of the subject sequence if a producer terminates prematurely.</p>
</div>
<div class="consider"><p>using <a class="xref" href="subjects.html#source-subjects">source subjects</a> when sharing a sequence with one consumer where data is generated by zero or more producers.</p>
</div>
<div class="consider"><p>moving all subject declarations to the top of the workflow. This will make sure that subject initialization order is easily readable from top to bottom.</p>
</div>
<h2 id="nested-operators">Nested Operators</h2>
<p>Several reactive operators require specification of a nested workflow, e.g. <a class="xref" href="../api/Bonsai.Reactive.SelectMany.html"><code>SelectMany</code></a> or <a class="xref" href="../api/Bonsai.Reactive.CreateObservable.html"><code>CreateObservable</code></a>. The operator itself will control when the nested workflow is initialized and subscribed to. If it is possible for a nested workflow to be executed multiple times, potentially in parallel, we call the operator <em>reentrant</em>. Some care is necessary to understand how to manage shared state and properties inside a reentrant nested operator.</p>
<div class="do"><p>use an <a class="xref" href="../api/Bonsai.Reactive.AsyncSubject.html"><code>AsyncSubject</code></a> to share workflow input data inside a nested operator.</p>
</div>
<div class="avoid"><p>using <a class="xref" href="../api/Bonsai.Expressions.PropertyMappingBuilder.html"><code>PropertyMapping</code></a> nodes inside reentrant nested operators.</p>
</div>
<h2 id="property-initialization">Property Initialization</h2>
<div class="donot"><p>branch a source sequence to share the same value across different <a class="xref" href="../api/Bonsai.Expressions.PropertyMappingBuilder.html"><code>PropertyMapping</code></a> nodes. This can introduce a race condition for operators that use property values at subscribe time.</p>
</div>
<p>Alternatively, you can either share the value using a subject, or branch after the <code>PropertyMapping</code> node (if both the value to share and the name of the property in each node are identical).</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/bonsai-rx/docs/blob/main/articles/workflow-guidelines.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script type="text/javascript" src="../styles/jquery.greedy-navigation.js"></script>
  </body>
</html>
